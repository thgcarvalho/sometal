<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pt"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>MetricasDoProjeto.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="right"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Sometal WebApp</a> &gt; <a href="index.html" class="el_package">br.com.grandev.util</a> &gt; <span class="el_source">MetricasDoProjeto.java</span></div><h1>MetricasDoProjeto.java</h1><pre class="source lang-java linenums">package br.com.grandev.util;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;

/**
 * @author Thiago Carvalho
 */
<span class="nc" id="L13">public class MetricasDoProjeto {</span>

	private String subDir;  
<span class="nc" id="L16">	private int somaLinhasJava = 0;</span>
<span class="nc" id="L17">	private int somaClassesJava = 0;</span>
<span class="nc" id="L18">	private int somaPaginasXHTML = 0;</span>
<span class="nc" id="L19">	private int somaLinhasXHTML = 0;</span>
<span class="nc" id="L20">	private int somaDiretorios = 0;</span>
<span class="nc" id="L21">	private String out = &quot;&quot;;</span>

	public static void main(String[] args) {

<span class="nc" id="L25">		MetricasDoProjeto mp = new MetricasDoProjeto();</span>
<span class="nc" id="L26">		String path = &quot;C:\\Users\\tcarvalho\\git\\sga&quot;; //JOptionPane.showInputDialog(&quot;Diret�rio do projeto: &quot;); </span>
<span class="nc" id="L27">		mp.contador(path);</span>

		// Apresenta os resultados no console
<span class="nc" id="L30">		System.err.println(&quot;\nSub-pastas do projeto = &quot; + mp.getSomaDiretorios());</span>
<span class="nc" id="L31">		System.err.println(&quot;Classes JAVA = &quot; + mp.getSomaClassesJava());</span>
<span class="nc" id="L32">		System.err.println(&quot;Linhas de c�digo JAVA = &quot; + mp.getSomaLinhasJava());</span>
<span class="nc" id="L33">		System.err.println(&quot;P�ginas XHTML = &quot; + mp.getSomaPaginasXHTML());</span>
<span class="nc" id="L34">		System.err.println(&quot;Linhas de p�ginas XHTML = &quot; + mp.getSomaLinhasXHTML());</span>

		// Adiciona os resultados obtidos ao atributo &quot;out&quot;, o qual ser� gravado no arquivo
<span class="nc" id="L37">		mp.setOut(&quot;\n\n\n\n=============================================&quot;</span>
				+ &quot;\nSub-pastas do projeto = &quot; + mp.getSomaDiretorios()
				+ &quot;\nClasses JAVA = &quot; + mp.getSomaClassesJava()
				+ &quot;\nLinhas de c�digo JAVA = &quot; + mp.getSomaLinhasJava()
				+ &quot;\nLinhas de c�digo JAVA = &quot; + mp.getSomaLinhasJava()
				+ &quot;\nLinhas de c�digo JAVA = &quot; + mp.getSomaLinhasJava());
		
<span class="nc" id="L44">		mp.gravaArquivoTxt(path, mp);</span>
<span class="nc" id="L45">	}</span>

	public void gravaArquivoTxt (String path, MetricasDoProjeto mp){
		try{      
			// Grava no arquivo
<span class="nc" id="L50">			File file = new File(path + &quot;/Metricas.txt&quot;);  </span>
<span class="nc" id="L51">			FileWriter fw = new FileWriter(file, true );</span>
			@SuppressWarnings(&quot;resource&quot;)
<span class="nc" id="L53">			PrintWriter ps = new PrintWriter(fw, true );  </span>
<span class="nc" id="L54">			ps.println(mp.getOut());  </span>
			//JOptionPane.showMessageDialog(null, &quot;Um arquivo com os resultados foi gerado no diret�rio do seu projeto!&quot;, &quot;Informa��o&quot;, JOptionPane.INFORMATION_MESSAGE);
<span class="nc" id="L56">		} catch (IOException e) {</span>
<span class="nc" id="L57">			e.printStackTrace();</span>
<span class="nc" id="L58">		}</span>
<span class="nc" id="L59">	}</span>

	public void contador(String path) {
<span class="nc" id="L62">		File diretorios = new File(path);  </span>
<span class="nc" id="L63">		File[] files = diretorios.listFiles();</span>

		/**
		 * � feita uma itera��o com o vetor que armazenou o path dos arq. e
		 * dirs. do dir. recebido como par�metro inicial
		 **/
<span class="nc bnc" id="L69" title="All 2 branches missed.">		for (int i = 0; i &lt; files.length; i++) {</span>
			
			/**
			 * Verifica se o camniho da posi��o atual do vetor &quot;files&quot;, � um
			 * arq. ou um dir., caso for um dir., ele entra no if
			 **/
<span class="nc bnc" id="L75" title="All 2 branches missed.">			if (files[i].isDirectory()) {</span>
				// Atribui o caminho do pr�ximo diret�rio � vari�vel &quot;subDir&quot;
<span class="nc" id="L77">				subDir = files[i].toString();</span>
<span class="nc" id="L78">				setOut(&quot;\n\nPath = &quot; + subDir);</span>
				
				// Ignora os diret�rios
<span class="nc bnc" id="L81" title="All 4 branches missed.">				if (subDir.endsWith(&quot;.git&quot;) || subDir.endsWith(&quot;.settings&quot;)) {</span>
<span class="nc" id="L82">					continue;</span>
				}
				
<span class="nc" id="L85">				System.out.println(&quot;\nPath = &quot; + subDir);</span>
				
				// Incrementa o atributo &quot;SomaDiretorios&quot;
<span class="nc" id="L88">				setSomaDiretorios(1);</span>

				try {
					/**
					 * Carrega em mem�ria todos os &quot;paths&quot; de dirs. e arqs. que
					 * est�o dentro do path armazenado em &quot;subDir&quot;
					 **/
<span class="nc" id="L95">					File dir = new File(subDir);</span>
<span class="nc" id="L96">					File[] file = dir.listFiles();</span>

					// Faz uma itera��o com o vetor &quot;file&quot;
<span class="nc bnc" id="L99" title="All 2 branches missed.">					for (int j = 0; j &lt; file.length; j++) {</span>

						// Carrega em mem�ria o path da posi��o atual do vetor &quot;file&quot;
<span class="nc" id="L102">						File f = new File(file[j].getPath());</span>

						/**
						 * Verifica se a posi��o atual do vetor &quot;file&quot; � um dir.
						 * caso n�o, ele entra
						 **/
						// JAVA
<span class="nc bnc" id="L109" title="All 4 branches missed.">						if (!(file[j].isDirectory()) &amp;&amp; file[j].getPath().endsWith(&quot;.java&quot;)){</span>

							// Armazena em buffer todo conte�do do arquivo
							@SuppressWarnings(&quot;resource&quot;)
<span class="nc" id="L113">							BufferedReader arquivo = new BufferedReader(new FileReader(f));  </span>
<span class="nc" id="L114">							int somaAux = 0;</span>

							// Enquanto n�o for final do arquivo ele persiste no la�o
<span class="nc bnc" id="L117" title="All 2 branches missed.">							while((arquivo.readLine()) != null){  </span>
								// A cada itera��o � correspondido a uma linha nova, assim o atributo &quot;somaLinhas&quot; � incrementado **/
<span class="nc" id="L119">								setSomaLinhasJava(1);</span>
<span class="nc" id="L120">								somaAux++;</span>
							}  

<span class="nc" id="L123">							int lastSlashIndex = file[j].getPath().lastIndexOf('/');</span>

							// Mostra na tela o arquivo + sua quantidade de linhas				
<span class="nc" id="L126">							System.err.println(file[j].getPath().substring(lastSlashIndex + 1) + &quot; = &quot; + somaAux + &quot; linhas&quot;);</span>
<span class="nc" id="L127">							setOut(&quot;\n\t &quot; + file[j].getPath().substring(lastSlashIndex + 1) + &quot; = &quot; + somaAux + &quot; linhas&quot;);</span>
							// O atributo &quot;somaClasses&quot; � incrementado � cada arquivo lido 
<span class="nc" id="L129">							setSomaClassesJava(1);</span>
						}
						// XHTML
<span class="nc bnc" id="L132" title="All 4 branches missed.">						if (!(file[j].isDirectory()) &amp;&amp; file[j].getPath().endsWith(&quot;.xhtml&quot;)){</span>

							// Armazena em buffer todo conte�do do arquivo
							@SuppressWarnings(&quot;resource&quot;)
<span class="nc" id="L136">							BufferedReader arquivo = new BufferedReader(new FileReader(f));  </span>
<span class="nc" id="L137">							int somaAux = 0;</span>

							// Enquanto n�o for final do arquivo ele persiste no la�o
<span class="nc bnc" id="L140" title="All 2 branches missed.">							while((arquivo.readLine()) != null){  </span>
								// A cada itera��o � correspondido a uma linha nova, assim o atributo &quot;somaLinhas&quot; � incrementado **/
<span class="nc" id="L142">								setSomaLinhasXHTML(1);</span>
<span class="nc" id="L143">								somaAux++;</span>
							}  

<span class="nc" id="L146">							int lastSlashIndex = file[j].getPath().lastIndexOf('/');</span>

							// Mostra na tela o arquivo + sua quantidade de linhas				
<span class="nc" id="L149">							System.err.println(file[j].getPath().substring(lastSlashIndex + 1) + &quot; = &quot; + somaAux + &quot; linhas&quot;);</span>
<span class="nc" id="L150">							setOut(&quot;\n\t &quot; + file[j].getPath().substring(lastSlashIndex + 1) + &quot; = &quot; + somaAux + &quot; linhas&quot;);</span>
							// O atributo &quot;somaClasses&quot; � incrementado � cada arquivo lido 
<span class="nc" id="L152">							setSomaPaginasXHTML(1);</span>
						}
					}

<span class="nc" id="L156">				} catch (Exception e) {</span>
<span class="nc" id="L157">					e.printStackTrace();</span>
<span class="nc" id="L158">				}</span>
				/**
				 *  Chama recursivamente a fun��o, s� que agora com o pr�ximo n�vel de diret�rio, 
				 *  assim consecutivamente at� que o �ltimo subdiret�rio seja encontrado.
				 */
<span class="nc" id="L163">				contador(subDir);</span>
			}	
		}
<span class="nc" id="L166">	}</span>

	public void setSomaLinhasJava(int somaLinhasJava) {
<span class="nc" id="L169">		this.somaLinhasJava = this.somaLinhasJava + somaLinhasJava;</span>
<span class="nc" id="L170">	}</span>

	public int getSomaLinhasJava() {
<span class="nc" id="L173">		return this.somaLinhasJava;</span>
	}

	public void setSomaClassesJava(int somaClassesJava) {
<span class="nc" id="L177">		this.somaClassesJava = this.somaClassesJava + somaClassesJava;</span>
<span class="nc" id="L178">	}</span>

	public int getSomaClassesJava() {
<span class="nc" id="L181">		return this.somaClassesJava;</span>
	}
	
	public void setSomaLinhasXHTML(int somaLinhasXHTML) {
<span class="nc" id="L185">		this.somaLinhasXHTML = this.somaLinhasXHTML + somaLinhasXHTML;</span>
<span class="nc" id="L186">	}</span>

	public int getSomaLinhasXHTML() {
<span class="nc" id="L189">		return this.somaLinhasXHTML;</span>
	}

	public void setSomaPaginasXHTML(int somaPaginasXHTML) {
<span class="nc" id="L193">		this.somaPaginasXHTML = this.somaPaginasXHTML + somaPaginasXHTML;</span>
<span class="nc" id="L194">	}</span>

	public int getSomaPaginasXHTML() {
<span class="nc" id="L197">		return this.somaPaginasXHTML;</span>
	}

	public void setSomaDiretorios(int somaDiretorios) {
<span class="nc" id="L201">		this.somaDiretorios = this.somaDiretorios + somaDiretorios;</span>
<span class="nc" id="L202">	}</span>

	public int getSomaDiretorios() {
<span class="nc" id="L205">		return this.somaDiretorios;</span>
	}

	public void setOut(String out) {
<span class="nc" id="L209">		this.out = this.out + out;</span>
<span class="nc" id="L210">	}</span>

	public String getOut() {
<span class="nc" id="L213">		return this.out;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.6.2.201302030002</span></div></body></html>