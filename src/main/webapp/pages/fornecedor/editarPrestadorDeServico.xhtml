<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" 
	template="/pages/template/template.xhtml">

	<ui:define name="corpo">
	<p:growl id="growl" showDetail="true" />

		<p:panel header="Edição de Prestador de Serviço" id="panel" style="height:650px;">
		
			<p:wizard flowListener="#{prestadorDeServicoBean.onFlowProcess}" nextLabel="Próximo" backLabel="Anterior"> 

			<p:focus context="panel" />
			
			<p:tab id="tab_fornecedor" title="Prestador de Serviço">
			
				<p:panel header="Dados do Prestador de Serviço">  
				
				<h:messages errorClass="error"/>  
              
				<h:panelGrid id="display" columns="3" cellpadding="40" style="margin:0 auto;">
	
					<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">
						<h:outputText value="Prestador: *" />
						<p:inputText required="true" label="Prestador" maxlength="60" size="40" 
							value="#{prestadorDeServicoBean.fornecedorSelecionado.nome}" />
	
						<h:outputText value="CPF:" />
						<p:inputMask id="cpf" label="CPF" value="#{prestadorDeServicoBean.fornecedorSelecionado.cadastro}" mask="999.999.999-99" size="14" onfocus="javascript:setCPF();" />
						<h:outputText value="CNPJ:" />
						<p:inputMask id="cnpj" label="CNPJ" value="#{prestadorDeServicoBean.fornecedorSelecionado.cadastro}" mask="99.999.999/9999-99" size="14" onfocus="javascript:setCNPJ();" />
	
						<h:outputText value="Fone1:" />
						<p:inputMask label="Fone1"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.fone1}" mask="(99) 9999-9999"
							maxlength="14" size="14" />
	
						<h:outputText value="Fone2:" />
						<p:inputMask label="Fone2"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.fone2}" mask="(99) 9999-9999"
							maxlength="14" size="14" />
	
						<h:outputText value="Endereco:" />
						<p:inputText label="Endereço"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.endereco}" maxlength="45"
							size="40" />
					</h:panelGrid>

					<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">
							<h:outputText value="Complemento:" />
						<p:inputText label="Complemento" 
							value="#{prestadorDeServicoBean.fornecedorSelecionado.complemento}" maxlength="45"
							size="40" />
	
						<h:outputText value="Número:" />
						<p:inputText label="Número"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.numero}" maxlength="16"
							size="14" />
							
						<h:outputText value="Bairro:" />
						<p:inputText label="Bairro"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.bairro}" maxlength="45"
							size="40" />
	
						<h:outputText value="Cidade:" />
						<p:inputText label="Cidade"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.cidade}" maxlength="45"
							size="40" />
	
						<h:outputText value="CEP:" />
						<p:inputMask label="CEP" value="#{prestadorDeServicoBean.fornecedorSelecionado.cep}"
							mask="99999-999" maxlength="10" size="14" />
	
						<h:outputText value="Email:" />
						<p:inputText label="Email"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.email}" maxlength="45"
							size="40" validator="#{prestadorDeServicoBean.validaEmail}" />
					</h:panelGrid>

					<h:panelGrid columns="2" columnClasses="label, value" styleClass="grid">
						<h:outputText value="Banco:" />
						<p:inputText label="Banco"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.banco}" maxlength="45"
							size="40" />
	
						<h:outputText value="Agência:" />
						<p:inputText label="agencia"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.agencia}" maxlength="16"
							size="14" />
	
						<h:outputText value="Conta:" />
						<p:inputText label="Conta"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.conta}" maxlength="16"
							size="14" />
							
						<h:outputText value="Obs:" />
						<p:inputTextarea label="Obs" rows="3" maxlength="250" cols="40"
							value="#{prestadorDeServicoBean.fornecedorSelecionado.obs}" autoResize="false">
						</p:inputTextarea>
					</h:panelGrid>
				</h:panelGrid>
				
				</p:panel>  
				
			</p:tab>
			
			<p:tab id="tab_condominios" title="Condomínios">
				<p:panel header="Dados dos Condomínios">  
				
				<h:messages errorClass="error"/>  
                
				<h:panelGrid id="condominios" columns="2">
				    <h:outputText value="Condomínios: *" />  
			        <p:selectManyMenu label="Condomínios" value="#{prestadorDeServicoBean.condominiosSelecionados}" style="width:800px;height:300px" showCheckbox="true" converter="CondominioConverter" required="true" >  
					   <f:selectItems value="#{condominioBean.listaCondominios}" var="condominio" itemLabel="#{condominio.nome}" itemValue="#{condominio}" />
			        </p:selectManyMenu> 
				</h:panelGrid>
				
				</p:panel>  
				
			</p:tab>
			
			<p:tab id="tab_servicos" title="Serviços">
				<p:panel header="Dados dos Serviços">  
				
				<h:messages errorClass="error"/>  
              
				<h:panelGrid id="servico" columns="3">  
		            <h:outputText value="Serviço:" />
		            <p:inputText label="Serviço" size="50" maxlength="96" value="#{prestadorDeServicoBean.oferta}" />  
		            <p:commandButton value="Adicionar" update="servicos growl @parent"  
		                            action="#{prestadorDeServicoBean.reinit}" >  
		                <p:collector value="#{prestadorDeServicoBean.oferta}"   
		                             addTo="#{prestadorDeServicoBean.fornecedorSelecionado.ofertas}" />  
		            </p:commandButton>  
		        </h:panelGrid> 
		        
		         <p:outputPanel id="servicos">  
			        <p:dataTable id="servicosTable" value="#{prestadorDeServicoBean.fornecedorSelecionado.ofertas}" var="oferta">  
			            <p:column>  
			                <f:facet name="header">  
			                    <h:outputText value="Serviço" />  
			                </f:facet>  
			                <h:outputText value="#{oferta}" />  
			            </p:column>  
			  
			            <p:column>  
			                <f:facet name="header">  
			                    <h:outputText value="Operação" />  
			                </f:facet>  
			                <p:commandLink value="Remover" update=":form:servicos" process=":form:servicos">  
			                    <p:collector value="#{oferta}" removeFrom="#{prestadorDeServicoBean.fornecedorSelecionado.ofertas}" />  
			                </p:commandLink>  
			            </p:column>  
			        </p:dataTable>  
			    </p:outputPanel>
				
				<div align="center">
					<br />
					<br />
					<h:panelGrid id="btn" columns="1"> 
						<p:commandButton id="btnSalvar" value="Salvar" icon="ui-icon-disk" 
							action="#{prestadorDeServicoBean.atualizar}"
			 	     		ajax="false" update="growl" rendered="#{prestadorDeServicoBean.fornecedorSelecionado ne null}" />
					</h:panelGrid>
				</div>
				</p:panel>  
				</p:tab>
			
			</p:wizard> 
			
		</p:panel>  
				
	</ui:define>
		
</ui:composition>